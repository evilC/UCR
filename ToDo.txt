********* Re-work profile switching system ************

Add CurrentPID property to UCR to save accessing the profile object all the time

Test setting / clearing profile for ProfileSwitcher
Calls UCR.ProfileLinksChanged

On profile change, activate new profile, then activate inherited profiles
Finally, asynchronously PreLoad profiles.
Should make profile switching smoother

*********************************************************

Investigate effect of saving on performance - esp big pauses.
Suspect calling serialize on all objects locks them up and causes problems.
Cache values? Move to random access storage? SQLite?
Plugin _OnInactive can no longer release held buttons

Profile Inheritance option not always showing in Profile Toolbox
Try adding menus to profiles and putting option in there?

Custom Serializers / Deserializers for IOClasses? Would also reduce INI file spam

Joystick button bindings need to be turned off for outputbuttons
When suspend, off happens, these become active even though they are not wanted.
Non-fatal as the bind handler does not accept them
Just add filter? Check if return type is not in mappings, and if so, do not fire callback

Remove _InputHandler?

Take a look at encoding of hat directions.
ATM, input is AHK Joy only, so only 1 hat, so Binding[1] can hold hat direction
for multi-hat IOClasses (eg vGen), this is currently encoded as (HatNum * 100) + Dir (eg 101, 201, 301, 401 for North of each 4 hats).
This requires some processing at run-time that could maybe be avoided by adding an extra property to that IOClass
Move Hat# to BindOptions?

IsEmptyAssoc in Plugin not working? GuiControls always in INI even if empty

From old ToDo:
* Sort out _RequestBinding / _RefreshBinding - may already be done?